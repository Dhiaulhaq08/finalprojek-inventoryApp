<%- include('../layout/header.ejs') %>
<link href="../bootstrap/css-tambahan/index.css" rel="stylesheet">
<%- include('../layout/navbar.ejs') %>

    <title>Update User Role</title>
   
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<body>
  <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">  
  <div class="container mt-5">
    <h1 class="text-center mb-4">Update User Role</h1>
    <p class="text-center mt-3">Register New User <a href="/register">Register here</a></p>
    <% if (successMessage.length > 0) { %>
      <div class="alert alert-success">
        <%= successMessage[0] %>
      </div>
    <% } %>
    
    <% if (errorMessage.length > 0) { %>
      <div class="alert alert-danger">
        <%= errorMessage[0] %>
      </div>
    <% } %>
    <% if (typeof message !== 'undefined' && message) { %>
      <div class="alert alert-success alert-dismissible fade show" role="alert">
        <%= message %>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    <% } %>

    <form action="/admin/update-role" method="POST" class="shadow p-4 rounded bg-light">
        <div class="mb-3">
            <label for="userId" class="form-label">Select User:</label>
            <select name="userId" id="userId" class="form-select" required>
                <% user.forEach(user => { %>
                    <option value="<%= user.id %>"><%= user.username %> (<%= user.role %>)</option>
                <% }) %>
            </select>
        </div>

        <div class="mb-3">
            <label for="role" class="form-label">New Role:</label>
            <select name="role" id="role" class="form-select" required>
                <option value="admin">Admin</option>
                <option value="user">User</option>
                <option value="admin_gudang">Admin gudang</option>
                <option value="admin_barang">Admin barang</option>
                <option value="admin_administrasi">Admin administrasi</option>
            </select>
        </div>

        <button type="submit" class="btn btn-primary w-100">Update Role</button>
    </form>

    <div class="mt-5">
        <h2 class="text-center mb-4">User List</h2>
        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Username</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <% user.forEach(user => { %>
                    <tr>
                        <td><%= user.id %></td>
                        <td><%= user.username %></td>
                        <td><%= user.email %></td>
                        <td><%= user.role %></td>
                        <td>
                            <a href="/admin/edit-role/<%= user.id %>" class="btn btn-sm btn-warning">Edit</a>
                            <form action="/admin/delete-user/<%= user.id %>" method="POST" class="d-inline">
                                <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                            </form>
                        </td>
                    </tr>
                <% }) %>
            </tbody>
        </table>
    </div>

</div>
        <div class="text-center mt-4">
            <a href="/" class="btn btn-secondary">Back To Home</a>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
<canvas class="my-4 w-100" id="myChart" width="900" height="380"></canvas>
</html>

